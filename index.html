<!DOCTYPE html>
<html lang="en" itemscope itemtype="https://schema.org/ItemList">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
  <title>AI Insight | Latest Artificial Intelligence News & Analysis</title>
  <meta name="description" content="Daily curated AI news and in-depth analysis on machine learning breakthroughs, neural networks, and industry trends. Stay updated with the latest developments in artificial intelligence.">
  <meta name="keywords" content="AI News, Machine Learning, Neural Networks, Deep Learning, Artificial Intelligence">
  <link rel="canonical" href="https://yourdomain.com/ai-news" />
  
  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "ItemList",
    "itemListElement": [
      {% raw %}{% for item in news_items %}
      {
        "@type": "ListItem",
        "position": {{ loop.index }},
        "item": {
          "@type": "NewsArticle",
          "headline": "{{ item.heading }}",
          "datePublished": "{{ item.timestamp|date('Y-m-d') }}",
          "url": "https://yourdomain.com/story/{{ item.uuid }}"
        }
      }{% if not loop.last %},{% endif %}
      {% endfor %}{% endraw %}
    ]
  }
  </script>

  <style>
    /* Minified CSS for better performance */
    body{font-family:Verdana,sans-serif;background:#f6f6ef;margin:0;padding:0}.header{background:#ff6600;color:#000;padding:10px;text-align:center;font-size:24px;font-weight:700}.container{width:90%;max-width:800px;margin:20px auto}.news-item{padding:8px 0;border-bottom:1px solid #e0e0e0}.news-item a{color:#000;text-decoration:none;font-size:16px;cursor:pointer}.news-item a:hover{text-decoration:underline}.subtext{margin-top:4px;color:#828282;font-size:12px}#story{display:none;padding:10px;background:#fff;border:1px solid #e0e0e0;margin-bottom:20px;position:relative}#close-story{position:absolute;top:10px;right:10px;background:#ff6600;color:#000;border:none;padding:5px 10px;cursor:pointer;font-size:16px}#story-content{margin-top:40px;white-space:pre-wrap;font-family:Verdana,sans-serif;overflow:auto;line-height:2rem}footer{text-align:center;padding:10px 0;font-size:12px;color:#828282;border-top:1px solid #e0e0e0;margin-top:20px}footer a{color:#828282;text-decoration:none}footer a:hover{text-decoration:underline}
  </style>
</head>
<body>
  <header class="header" role="banner" aria-label="Site header">
    <h1 itemprop="name">AI Insight</h1>
    <meta itemprop="description" content="Comprehensive AI news aggregation and analysis platform">
  </header>

  <main class="container" role="main" aria-label="Main content">
    <div id="story" role="article" itemscope itemtype="https://schema.org/NewsArticle">
      <button id="close-story" aria-label="Close story">X</button>
      <div id="story-content" itemprop="articleBody"></div>
    </div>

    <nav id="news" role="navigation" aria-label="News listing">
      <!-- Server-side rendering placeholder -->
      <noscript>
        <div class="news-item">
          <h2>Latest AI News</h2>
          <p>Enable JavaScript to view interactive content or see our <a href="/static-news">static news archive</a>.</p>
        </div>
      </noscript>
    </nav>
  </main>

  <footer role="contentinfo" aria-label="Site footer">
    <p>Â© 2025 AI Insight. All rights reserved. <a href="/sitemap.xml" aria-label="XML Sitemap">Sitemap</a></p>
  </footer>
  
  <!-- Preload critical resources -->
  <link rel="preload" href="./mind/mind.csv" as="fetch" crossorigin>
  <script>
    // Enhanced structured data injection
    function injectStructuredData(items) {
      const schemaScript = document.createElement('script');
      schemaScript.type = 'application/ld+json';
      schemaScript.textContent = JSON.stringify({
        "@context": "https://schema.org",
        "@type": "ItemList",
        "itemListElement": items.map((item, index) => ({
          "@type": "ListItem",
          "position": index + 1,
          "item": {
            "@type": "NewsArticle",
            "headline": item.heading,
            "datePublished": new Date(item.timestamp).toISOString(),
            "url": window.location.href + '?story=' + item.uuid
          }
        }))
      });
      document.head.appendChild(schemaScript);
    }

 /**
     * Parse a CSV line in the format:
     *   timestamp,uuid,heading
     * The heading may contain commas, so we split only on the first two commas.
     */
    function parseCSVLine(line) {
      const firstComma = line.indexOf(',');
      const secondComma = line.indexOf(',', firstComma + 1);
      if (firstComma === -1 || secondComma === -1) {
        return { timestamp: "", uuid: "", heading: line };
      }
      const timestamp = line.substring(0, firstComma).trim();
      const uuid = line.substring(firstComma + 1, secondComma).trim();
      const heading = line.substring(secondComma + 1).trim();
      return { timestamp, uuid, heading };
    }

    // Fetch the CSV file (mind.csv) from the /mind/ directory
    fetch('./mind/mind.csv')
      .then(response => {
        if (!response.ok) {
          throw new Error('Failed to load mind.csv');
        }
        return response.text();
      })
      .then(text => {
        const lines = text.split("\n").filter(line => line.trim() !== "");
        const newsContainer = document.getElementById("news");
        let html = "";
        let rank = 1;
        lines.forEach(line => {
          const item = parseCSVLine(line);
          // Convert the RFC timestamp to a human-friendly format if possible

          html += '<div class="news-item">';
          html += '<span>' + rank + '. </span>';
          // The anchor uses a data-uuid attribute for fetching the story.
          html += '<a href="#" data-uuid="' + item.uuid + '">' + item.heading + '</a>';
          html += '<div class="subtext">' + item.timestamp + '</div>';
          html += '</div>';
          rank++;
        });
        newsContainer.innerHTML = html;

        // Add click event listeners to each story link
        document.querySelectorAll('.news-item a').forEach(link => {
          link.addEventListener('click', function(e) {
            e.preventDefault();
            const uuid = this.getAttribute('data-uuid');
            // Fetch the story text from /mind/stories/{uuid}.txt
            fetch('https://cryptoroom203.github.io/AI-insight/mind/stories/' + uuid + '.txt')
              .then(response => {
                if (!response.ok) {
                  throw new Error("Could not load story");
                }
                return response.text();
              })
              .then(text => {
                // Hide the news list and show the story container with the story content
                document.getElementById("news").style.display = "none";
                document.getElementById("story-content").innerHTML = text;
                document.getElementById("story").style.display = "block";
              })
              .catch(err => {
                console.error(err);
                alert("Failed to load story.");
              });
          });
        });
      })
      .catch(error => {
        console.error(error);
        document.getElementById("news").innerHTML = "<p>Error loading news.</p>";
      });

    // When the user clicks the close button, hide the story view and show the news list again.
    document.getElementById("close-story").addEventListener("click", function() {
      document.getElementById("story").style.display = "none";
      document.getElementById("news").style.display = "block";
    });
  </script>
</body>
</html>
